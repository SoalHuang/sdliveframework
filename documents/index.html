<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SDLiveProject  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="SDLiveProject  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SDLiveProject 1.1.7 Docs</a> (25% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SDLiveProject Reference</a>
        <img id="carat" src="img/carat.png" />
        SDLiveProject  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="changelog.html">ChangeLog</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/SDLPrompView.html">SDLPrompView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveAnnouncementView.html">SDLiveAnnouncementView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveAnserQuestionCollectionViewCell.html">SDLiveAnserQuestionCollectionViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveAnserQuestionView.html">SDLiveAnserQuestionView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveAudioService.html">SDLiveAudioService</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveBigResponseView.html">SDLiveBigResponseView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveChatFullTableViewCell.html">SDLiveChatFullTableViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveChatLeftTableViewCell.html">SDLiveChatLeftTableViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveChatRightTableViewCell.html">SDLiveChatRightTableViewCell</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveChatView.html">SDLiveChatView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveConverView.html">SDLiveConverView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveDefaultPlayerViewController.html">SDLiveDefaultPlayerViewController</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveDownloadItem.html">SDLiveDownloadItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveDownloadManager.html">SDLiveDownloadManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveEnvironment.html">SDLiveEnvironment</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveEnvironmentService.html">SDLiveEnvironmentService</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveError.html">SDLiveError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveFullSettingView.html">SDLiveFullSettingView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveHorizontalScrollText.html">SDLiveHorizontalScrollText</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMAnnounceModel.html">SDLiveIMAnnounceModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMChatRoomEvent.html">SDLiveIMChatRoomEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMChatRoomModel.html">SDLiveIMChatRoomModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMMessageModel.html">SDLiveIMMessageModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLog.html">SDLiveLog</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginInfoModel.html">SDLiveLoginInfoModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginModel.html">SDLiveLoginModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginResModel.html">SDLiveLoginResModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveManager.html">SDLiveManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveMenuView.html">SDLiveMenuView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveMessageInputBar.html">SDLiveMessageInputBar</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveMoreButton.html">SDLiveMoreButton</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePageContainerView.html">SDLivePageContainerView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePaperModel.html">SDLivePaperModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePlayeMutipleLines.html">SDLivePlayeMutipleLines</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePlayerView.html">SDLivePlayerView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveProgressDisplayView.html">SDLiveProgressDisplayView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes.html#/c:objc(cs)SDLivePublicDefine">SDLivePublicDefine</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveQuestionResultView.html">SDLiveQuestionResultView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveRoomInfo.html">SDLiveRoomInfo</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveSettingMoreView.html">SDLiveSettingMoreView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveTextView.html">SDLiveTextView</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Constants.html#/c:SDLiveDownloadManager.h@SDLiveDownloadErrorDomain">SDLiveDownloadErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveErrorDomain">SDLiveErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveMessageInputBarDidResizeNotification">SDLiveMessageInputBarDidResizeNotification</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveMessageInputBarSizeUserInfoKey">SDLiveMessageInputBarSizeUserInfoKey</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveProjectVersionNumber">SDLiveProjectVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveProjectVersionString">SDLiveProjectVersionString</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveServerErrorDomain">SDLiveServerErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:SDLiveDownloadManager.h@SunliveDownloadIdentifier">SunliveDownloadIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@sdlive_sdk_version">sdlive_sdk_version</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/SDLiveClientType.html">SDLiveClientType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveConfig.html">SDLiveConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveIMChatRoomEventType.html">SDLiveIMChatRoomEventType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveImageLoadStatus.html">SDLiveImageLoadStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMessageInputBarStyle.html">SDLiveMessageInputBarStyle</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMovieLoadState.html">SDLiveMovieLoadState</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMoviePlaybackState.html">SDLiveMoviePlaybackState</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMovieScalingMode.html">SDLiveMovieScalingMode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveProgressDirection.html">SDLiveProgressDirection</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomEvent.html">SDLiveRoomEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomPeopleEvent.html">SDLiveRoomPeopleEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomStatus.html">SDLiveRoomStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveServerErrorCode.html">SDLiveServerErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveSocketError.html">SDLiveSocketError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveTextViewMaxLengthType.html">SDLiveTextViewMaxLengthType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveUserRoleType.html">SDLiveUserRoleType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDSocketState.html">SDSocketState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/SDLiveBigResponseViewDelegate.html">SDLiveBigResponseViewDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveChatViewDelegate.html">SDLiveChatViewDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveDefaultPlayerViewControllerDelegate.html">SDLiveDefaultPlayerViewControllerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveDownloadManagerDelegate.html">SDLiveDownloadManagerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveEnvironmentProtocol.html">SDLiveEnvironmentProtocol</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveIMDelegate.html">SDLiveIMDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveLogger.html">SDLiveLogger</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveManagerDelegate.html">SDLiveManagerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveMessageInputBarDelegate.html">SDLiveMessageInputBarDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLivePlayeMutipleLinesDelegate.html">SDLivePlayeMutipleLinesDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Type%20Definitions.html">Type Definitions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveConverView.h@T@SDLCoverViewHiddenClosures">SDLCoverViewHiddenClosures</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveAnserQuestionView.h@T@SDLiveAnserQuestionViewBlock">SDLiveAnserQuestionViewBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveAudioService.h@T@SDLiveAudioServiceBlock">SDLiveAudioServiceBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePublicDefine.h@T@SDLiveBtnActionBlock">SDLiveBtnActionBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadDeleteResult.html">SDLiveDownloadDeleteResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadError.html">SDLiveDownloadError</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadResult.html">SDLiveDownloadResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadStatus.html">SDLiveDownloadStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveFakeLiveMode.html">SDLiveFakeLiveMode</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveHorizontalScrollText.h@T@SDLiveHorizontalScrollFinishBlock">SDLiveHorizontalScrollFinishBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveDefine.h@T@SDLiveNumber">SDLiveNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerCompleteBlock">SDLivePlayerCompleteBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerErrorBlock">SDLivePlayerErrorBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerLoadStatusCallBlock">SDLivePlayerLoadStatusCallBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerStatusCallBlock">SDLivePlayerStatusCallBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveSettingMoreView.h@T@SDLiveSliderActionBlock">SDLiveSliderActionBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveFullSettingView.h@T@SDLiveSwitchActionBlock">SDLiveSwitchActionBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveTextScrollMode.html">SDLiveTextScrollMode</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveTextScrollMoveDirection.html">SDLiveTextScrollMoveDirection</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveTextView.h@T@SDLiveTextViewDidChangeBlock">SDLiveTextViewDidChangeBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDVideoType.html">SDVideoType</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SUNLAND_SDK_DOWNLOAD_LIVE_ERROR.html">SUNLAND_SDK_DOWNLOAD_LIVE_ERROR</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/UrlSteamType.html">UrlSteamType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/c:@F@SDLiveLogEventDebug">SDLiveLogEventDebug</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='sdliveproject' class='heading'>SDLiveProject</h1>

<p>SDLiveProject 是尚直播的 iOS 端 SDK ，可以观看尚直播平台的直播以及点播，集成方便。</p>
<h2 id='功能' class='heading'>功能</h2>

<ul>
<li>[x] 在线观看直播</li>
<li>[x] 发送弹幕</li>
<li>[x] 在线观看点播</li>
<li>[x] 离线观看点播</li>
<li>[x] 获取音频文件下载链接</li>
<li>[x] 在线观看碎片化视频</li>
</ul>
<h2 id='安装条件' class='heading'>安装条件</h2>

<ul>
<li>iOS7.0 +</li>
<li><a href="https://cocoapods.org">CocoaPods</a></li>
</ul>
<h2 id='2-安装' class='heading'>2.安装</h2>

<p>在 <code>Podfile</code> 添加</p>

<ul>
<li>持续获取最新版本</li>
</ul>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'SDLiveFramework'</span><span class="p">,</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s1">'https://github.com/jokerYellow/sdliveframework.git'</span>
</code></pre>

<ul>
<li>稳定版本</li>
</ul>
<pre class="highlight ruby"><code><span class="n">pod</span> <span class="s1">'SDLiveFramework'</span><span class="p">,</span><span class="ss">:git</span><span class="o">=&gt;</span><span class="s1">'https://github.com/jokerYellow/sdliveframework.git'</span><span class="p">,</span><span class="ss">:tag</span><span class="o">=&gt;</span><span class="s1">'1.1.7'</span>
</code></pre>

<blockquote>
<p><strong>如果主工程有引入欢拓</strong>，请在安装尚直播之后测试欢拓功能是否正常，有问题请联系<a href="huangyaqing@sunlands.com">尚直播技术人员 huangyaqing@sunlands.com</a></p>
</blockquote>
<h2 id='3-使用方法' class='heading'>3.使用方法</h2>

<p>### - 环境配置，在调用初始化方法之前配置</p>
<pre class="highlight plaintext"><code>  //SDLiveConfigDevelop 开发环境【内部环境】
  //SDLiveConfigQA 测试环境
  //SDLiveConfigProduct 生产环境
  [SDLiveManager setConfigType:SDLiveConfigProduct];
</code></pre>

<p>### - 初始化</p>
<pre class="highlight plaintext"><code>//初始化环境
[SDLiveManager setConfigType:SDLiveConfigProduct];
//初始化登录实例
SDLiveLoginInfoModel* model =  [[SDLiveLoginInfoModel alloc] init];
model.roomId = 1010;
model.userId = @"userId";
model.userRole = SDLiveUserRoleStudent;
model.userName = @"jack";
model.partnerId = @"partnerId";
model.terminalType = SDLiveClientIOSType;
model.ts = ceil([[NSDate date] timeIntervalSince1970]);
model.userAvatar = @"headUrl";
model.sign = @"xxxxxx";

//初始化直播Manager，如果是点播，则传入SDLiveVideoType
self.liveManager = [[SDLiveManager alloc] initLiveWith:model type:SDVideoLiveType]; 
//配置直播代理
self.liveManager.delegate = self;
//配置弹幕代理
self.liveManager.imDelegate = self;
//对播放器进行布局
[self.view addSubview:self.liveManager.playerView];
//对课件进行布局
[self.view addSubview:self.liveManager.pageView];

//播放
[self.liveManager play];
</code></pre>
<h3 id='基础功能' class='heading'>- 基础功能</h3>

<p>发送弹幕【直播】</p>
<pre class="highlight plaintext"><code>  [self.liveManager sendMessage: @"hello,world!"];
</code></pre>

<p>暂停播放【点播】</p>
<pre class="highlight plaintext"><code>  [self.liveManager pause];
</code></pre>

<p>继续播放【点播】</p>
<pre class="highlight plaintext"><code>  [self.liveManager resume];
</code></pre>

<p>停止播放，停止之后，无法恢复播放，会释放相关的内存
  一般情况下，在控制器销毁的时候，不用调用该方法
  在SDLiveManager的dealloc方法里，内部会调用该方法</p>
<pre class="highlight plaintext"><code>  [self.liveManager stop];
</code></pre>

<p>拖拽播放，内部会对time做floor(time)处理，比如上次播放到10s了，这次需要继续在10s处播放【点播】</p>
<pre class="highlight plaintext"><code>  [self.liveManager dragTo:10];
</code></pre>

<p>调整倍速，点播下可用【点播】</p>
<pre class="highlight plaintext"><code>  self.liveManager.playSpeed = 1.5;
</code></pre>
<h3 id='主要的直播间代理回调方法-code-sdlivemanagerdelegate-code' class='heading'>- 主要的直播间代理回调方法<code><a href="Protocols/SDLiveManagerDelegate.html">SDLiveManagerDelegate</a></code></h3>
<pre class="highlight plaintext"><code>/**
 时间回调

 @param manager
 @param duration 视频总时长
 @param currentPlayTime 当前播放时长
 @param cachedDuration 已缓存的视频时长
 */
- (void)manager:(SDLiveManager*)manager
       duration:(NSTimeInterval)duration
currentPlayTime:(NSTimeInterval)currentPlayTime
cacheVideoDuration:(NSTimeInterval)cachedDuration;

/**
 播放器状态回调

 @param manager
 @param state 状态，包括暂停、加载、播放等状态
 */
- (void)manager:(SDLiveManager*)manager
      playState:(SDLiveMoviePlaybackState)state;

/**
 房间信息回调

 @param manager
 @param roomInfo 房间信息类，包含房间名称、老师名称等信息
 */
- (void)manager:(SDLiveManager*)manager
       roomInfo:(SDLiveRoomInfo*)roomInfo;

/**
 直播间事件回调

 @param manager
 @param event 事件，【开始直播、结束直播、暂停直播、恢复直播】
 @param message 附加信息
 */
- (void)managerLiveEventOccur:(SDLiveManager*)manager
                        event:(SDLiveRoomEvent)event
                      message:(NSString*)message;

/**
 直播间异常回调

 @param manager
 @param error 错误对象，userInfo里为附加信息
 */
- (void)manager:(SDLiveManager*)manager
        onError:(NSError*)error;
</code></pre>
<h3 id='主要的弹幕代理回调方法-code-sdliveimdelegate-code' class='heading'>- 主要的弹幕代理回调方法<code><a href="Protocols/SDLiveIMDelegate.html">SDLiveIMDelegate</a></code></h3>
<pre class="highlight plaintext"><code> IM 错误码，登录以及发送消息代理返回的 result 变量
 0 : 服务器返回正确；
 1 : 数据库错误；
 2 : 入参错误；
 3 : 直播间不存在；
 4 : json解析错误；
 5 : 直播间不存在改成员；
 6 : 直播间禁言；
 7 : 敏感词屏蔽；
 8 : 非注册用户；
 9 : 用户无操作权限；
 10 : 直播间满员；
 11: 直播间用户被单独禁言
 12： 学生已经被踢出直播间
 13：消息超过长度限制(140汉字)。
 14： 发送消息频率超过最大频率
 15： 第三方签名校验错误
 16： 第三方合作方id不存在 
</code></pre>
<pre class="highlight plaintext"><code>/**
 收到服务端发来的新消息

 @param messages 消息列表
 */
-(void)didReceiveMessageList:(NSArray&lt;SDLiveIMMessageModel*&gt;*)messages;

/**
 聊天室登录成功，返回基本的聊天室信息，如登录人员信息、禁言状态、聊天室人数、登录token等
 用户登录之后会返回部分之前的消息
 当app长链接断开重连的时候，也会调用该方法，所以需要注意登录返回的消息会重复。

 @param model SDLiveIMChatRoomModel

 @param result 错误码
 */
-(void)didLogin:(SDLiveIMChatRoomModel* _Nonnull)model
    MessageList:(NSArray&lt;SDLiveIMMessageModel*&gt;* _Nullable)messages
     withResult:(NSInteger)result;

/**
 消息发送成功，返回发送成功的消息

 @param message 聊天消息数据

 @param result 错误码
 */
-(void)didSendMessage:(SDLiveIMMessageModel* _Nonnull)message
           withResult:(NSInteger)result;

/**
 用户批量下线通知，聊天人数变更

 @param number 剩余聊天人数
 */
- (void)didChatRoomBatchOffline:(NSInteger)number;

/**
 用户进入、退出聊天室回调，会返回聊天室当前人数、以及退出用户的信息

 @param event SDLiveIMChatRoomEvent
 */
- (void)didRoomUserEvent:(SDLiveIMChatRoomEvent*)event;

/**
 * 个人禁言，收到禁言/解禁 通知，禁止或允许用户发送信息，
 * status false：不禁言，true：禁言
 * */
- (void)didChatRoomDidForbiddenUserTalk:(Boolean)status;

/**

 该通知用于老师或者助教更新本地的学员大表和被踢用户列表。
 1. 老师或者助教主动将某个学员踢出直播间, 该通知会发送给被踢人以及其他的老师或者助教。
 2. 老师或者助教主动将某个学员取消踢人状态，该通知会发送给其他老师或者助教。
 @param status false：不禁言，true：禁言
 */
- (void)didChatRoomDidUserBeKickOff:(Boolean)status;
</code></pre>
<h3 id='高级功能' class='heading'>- 高级功能</h3>
<h4 id='离线播放' class='heading'>离线播放</h4>

<ol>
<li>原理

<ul>
<li>通过<a href="https://developer.apple.com/documentation/foundation/url_loading_system/downloading_files_in_the_background">原生后台下载</a>的方式将视频以及事件、图片资源下载到本地。</li>
<li>下载完毕之后，使用点播方式进行播放即可。如果已经离线完毕，SDK会使用离线数据进行播放，否则使用线上数据。</li>
</ul></li>
<li>开始下载

<ul>
<li>SDK提供两种方式，一种平台化下载，一种尚直播下载，尚直播的方式在以后会被废弃掉。</li>
<li>如果该直播正在下载中，或者已经下载完毕，或者传入参数错误，则在初始化的时候会返回错误，可以根据对应的<code><a href="Type%20Definitions/SUNLAND_SDK_DOWNLOAD_LIVE_ERROR.html">SUNLAND_SDK_DOWNLOAD_LIVE_ERROR</a></code>来处理错误。
&ldquo;` objective-c
/// 尚直播下载方法 
NSError* error = [[SDLiveDownloadManager shared] downloadWith:liveId withToken:self.token.text andChannelCode:self.channelCode.text];
if (error != nil) {
//handle initial error;
}</li>
</ul></li>
</ol>

<p>/// 平台化下载方法 
  NSError* error = [[SDLiveDownloadManager shared] downloadWithPlatInfo:model];
  if (error != nil) {
    //handle initial error;
  }</p>
<pre class="highlight plaintext"><code>3. ⚠️注意的点, 在`APPDelegate`下的回调`handleEventsForBackgroundURLSession` 里添加该方法。

```objective-c
 - (void)application:(UIApplication *)application handleEventsForBackgroundURLSession:(NSString *)identifier completionHandler:(void (^)(void))completionHandler{
    [[SDLiveDownloadManager shared] handleEventsForBackgroundURLSession:identifier completionHandler:completionHandler];
 }
</code></pre>

<ol>
<li>操作方法

<ul>
<li>暂停</li>
</ul></li>
</ol>
<pre class="highlight plaintext"><code>  /// 暂停下载，如传入的roomId不在下载列表里，不会做任何操作；
/// 对下载已经完毕或者被暂停不生效
/// @param roomId 直播间ID
- (void)pauseWithRoomId:(NSInteger)roomId;
</code></pre>

<ul>
<li><p>恢复</p>
<pre class="highlight plaintext"><code>/// 恢复下载，如传入的roomId不在下载列表里，不会做任何操作
/// 对下载已经完毕或者被暂停不生效
/// @param roomId 直播间ID
- (void)resumeWithRoomId:(NSInteger)roomId;
</code></pre>

<ul>
<li>停止
<code>objective-c
/// 停止下载，如传入的roomId不在下载列表里，不会做任何操作
/// @param roomId 直播间ID
- (void)stopWithRoomId:(NSInteger )roomId;
</code></li>
<li>可以删除掉已经下载完毕的直播
<code>objective-c
/// 删除某个已经完成的下载，可用于清除缓存，如传入的roomId不在下载列表里，不会做任何操作
/// 仅对下载完毕的下载项生效
/// @param roomId 直播间ID
- (void)removeCachesWithRoomId:(NSInteger )roomId;
</code></li>
<li>获取下载列表，<code><a href="Classes/SDLiveDownloadItem.html">SDLiveDownloadItem</a></code>包含下载状态以及直播间等信息
<code>objective-c
/// 获取下载列表
- (NSArray&lt;SDLiveDownloadItem *&gt; *)getDownloadList;
</code></li>
</ul></li>
</ul>

<p>离线播放代理</p>
<pre class="highlight plaintext"><code>/**
 下载代理
 */
@protocol SDLiveDownloadManagerDelegate &lt;NSObject&gt;
/// 下载认证失败
/// @param manager
/// @param roomId 直播间ID
/// @param error 错误信息
- (void)downloadManager:(SDLiveDownloadManager *_Nonnull)manager
                   roomId:(NSInteger)roomId
    authorizationFailed:(NSError *_Nullable)error;

/// 开始下载
/// @param manager
/// @param roomId 直播间ID
- (void)downloadManager:(SDLiveDownloadManager *_Nonnull)manager
      beginDownloadRoomId:(NSInteger)roomId;

/// 下载进度变化
/// @param manager SDLiveDownloadManager
/// @param roomId 直播间ID
/// @param downloadSize 已经下载的比特数
/// @param totalSize 该直播间总共比特数
- (void)downloadManager:(SDLiveDownloadManager *_Nonnull)manager
                   roomId:(NSInteger)roomId
         progressChange:(NSInteger)downloadSize
              totalSize:(NSInteger)totalSize;

/// 下载过程中发生错误
/// @param manager SDLiveDownloadManager
/// @param roomId 直播间ID
/// @param error 错误信息
- (void)downloadManager:(SDLiveDownloadManager *_Nonnull)manager
                   roomId:(NSInteger)roomId
          errorOccurred:(NSError *_Nullable)error;

/// 下载完成
/// @param manager SDLiveDownloadManager
/// @param roomId 直播间ID
/// @param error 下载完成时可能出现的错误信息
- (void)downloadManager:(SDLiveDownloadManager *_Nonnull)manager
                   roomId:(NSInteger)roomId
               complete:(NSError *_Nullable)error;

@end
</code></pre>
<h4 id='获取音频文件链接' class='heading'>获取音频文件链接</h4>

<p>SDLiveAudioService 类提供音频下载方法</p>
<pre class="highlight plaintext"><code>/**
 平台化音频下载

 @param model SDLiveLoginInfoModel 平台化参数
 @param complete 返回（downloadUrl，fileSize，error）
 @return 操作成功或失败
 */

- (BOOL)requestAudioInfomationWithPlatInfo:(SDLiveLoginInfoModel *)model
                                  complete:(SDLiveAudioServiceBlock)complete;
</code></pre>
<h4 id='平台化碎片化初始化方式' class='heading'>平台化碎片化初始化方式</h4>
<pre class="highlight plaintext"><code>/**
 平台化业务方碎片化视频初始化
 @param model SDLiveLoginInfoModel
 @param videoId 短视频ID
 @param extraJson 短视频扩展Json
 @param startSequence 短视频开始sequence
 @param endSequence 短视频结束sequence
 @return SDLiveManager
 */
- (instancetype _Nonnull)initLiveWith:(SDLiveLoginInfoModel* _Nonnull)model
                              videoId:(SDLiveNumber)videoId
                            extraJson:(NSString* _Nonnull)extraJson
                        startSequence:(SDLiveNumber)startSequence
                          endSequence:(SDLiveNumber)endSequence;
</code></pre>
<h4 id='营销推广商品' class='heading'>营销推广商品</h4>

<p>修改方法，添加同步序列</p>
<pre class="highlight plaintext"><code>/**
 时间回调

 @param manager SDLiveManager
 @param duration 视频总时长
 @param currentPlayTime 当前播放时长
 @param cachedDuration 已缓存的视频时长
 @param sequence 同步序列
 */
- (void)manager:(SDLiveManager* _Nonnull)manager
       duration:(NSTimeInterval)duration
currentPlayTime:(NSTimeInterval)currentPlayTime
cacheVideoDuration:(NSTimeInterval)cachedDuration
       sequence:(NSTimeInterval)sequence;
</code></pre>

<p>新增方法</p>
<pre class="highlight plaintext"><code>/// 商品推广消息【该方法仅在直播下触发】
/// @param manager SDLiveManager
/// @param goods 商品数组,element为nsdictionary，包含id、name、pictureUrl、locateUrl等key
/// @param operate 0 开启推广，1 关闭推广
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveGoods:( NSArray* _Nullable)goods
       operate:(NSInteger)operate;

/// 商品推广消息【该方法仅在点播下触发】
/// @param manager SDLiveManager
/// @param originGoodsInfo 字典数组
/** originGoodsInfo 结构如下
  (
  {
      data =     (
                  {
              id = 19;
              locateUrl = "http://cn.bing.com";
              name = name3;
              pictureUrl = "https://test-sfs-public.shangdejigou.cn/SunlivePromote/aaa3";
          },
                  {
              id = 20;
              locateUrl = "http://cn.bing.com";
              name = name4;
              pictureUrl = "https://test-sfs-public.shangdejigou.cn/SunlivePromote/aaa4";
          }
      );
      lSequence = 1581942366849;
      operate = 1;
  },
  {
      data =     (
                  {
              id = 19;
              locateUrl = "http://cn.bing.com";
              name = name3;
              pictureUrl = "https://test-sfs-public.shangdejigou.cn/SunlivePromote/aaa3";
          },
                  {
              id = 20;
              locateUrl = "http://cn.bing.com";
              name = name4;
              pictureUrl = "https://test-sfs-public.shangdejigou.cn/SunlivePromote/aaa4";
          }
      );
      lSequence = 1581942499606;
      operate = 0;
  }
  )
 */
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveOriginGoodsInfo:( NSArray* _Nullable)originGoodsInfo;

</code></pre>
<h4 id='抽奖通知' class='heading'>抽奖通知</h4>

<p>App端主要是抽奖开始和结束通知</p>
<pre class="highlight plaintext"><code>/// 开始抽奖通知
/// @param manager SDLiveManager
/// @param name 奖品名称
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveStartRaffle:( NSString* _Nullable)name;

/// 学员端抽奖结果通知
/// @param manager SDLiveManager
/// @param name 奖品名称
/// @param isSelf 自己是否是中奖用户
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveEndRaffle:( NSString* _Nullable)name
winner:(BOOL)isSelf;

</code></pre>
<h4 id='答题功能' class='heading'>答题功能</h4>

<p>App端主要是答题开始和答题结束通知，以及发送答题答案接口</p>
<pre class="highlight plaintext"><code>/// 学员端抽奖结果通知
/// @param manager SDLiveManager
/// @param name 奖品名称
/// @param isSelf 自己是否是中奖用户
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveEndRaffle:( NSString* _Nullable)name
winner:(BOOL)isSelf;

///  发给学员的答题信息
/// @param manager SDLiveManager
/// @param questiontype 题目类型。1-单选 2-多选",
/// @param lSequence 请求毫秒级时间戳
/// @param optionCount 选项个数(2-5)",
/// @param answer 排好序的答案ABC..., 无答案传空串
-(void)manager:(SDLiveManager* _Nonnull)manager
didReceiveQuestionType:(NSNumber* _Nonnull)questiontype
      sequence:(NSNumber* _Nonnull)lSequence
   optionCount:(NSNumber* _Nonnull)optionCount
        answer:(NSString* _Nonnull)answer;


///  发送答题答案
/// @param answer 答案，为排好序的字符串，如"BC"
/// @param lSequence 时间戳
- (void)sendQuestionAnser:(NSString* _Nonnull)answer sequence: (NSNumber *_Nonnull)lSequence;
</code></pre>
<h4 id='默认播放页功能' class='heading'>默认播放页功能</h4>

<p>主要为SDLiveDefaultPlayerViewController相关的接口和功能</p>
<h4 id='环境配置' class='heading'>环境配置</h4>

<p>当前有四套默认的环境与自定义环境的时候与SDLiveConfig一一对应，可以通过枚举赋值。</p>
<pre class="highlight plaintext"><code>+ (void)setConfigType:(SDLiveConfig)type;
</code></pre>

<p>如要自定义环境，可以实现<code>SDLiveEnvironmentProtocol</code>协议，然后给<code>SDLiveEnvironmentService</code>单例赋值。</p>
<pre class="highlight plaintext"><code>let env : SDLiveEnvironmentProtocol
SDLiveEnvironmentService.shared.env = env
</code></pre>

          </section>
        </section>
        <section id="footer">
          <p>2019@Sunland</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
