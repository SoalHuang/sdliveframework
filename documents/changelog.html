<!DOCTYPE html>
<html lang="en">
  <head>
    <title>ChangeLog  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="ChangeLog  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">SDLiveProject 1.0.5 Docs</a> (29% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">SDLiveProject Reference</a>
        <img id="carat" src="img/carat.png" />
        ChangeLog  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="changelog.html">ChangeLog</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/SDLiveAudioService.html">SDLiveAudioService</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveDownloadItem.html">SDLiveDownloadItem</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveDownloadManager.html">SDLiveDownloadManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveError.html">SDLiveError</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMAnnounceModel.html">SDLiveIMAnnounceModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMChatRoomEvent.html">SDLiveIMChatRoomEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMChatRoomModel.html">SDLiveIMChatRoomModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveIMMessageModel.html">SDLiveIMMessageModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLog.html">SDLiveLog</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginInfoModel.html">SDLiveLoginInfoModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginModel.html">SDLiveLoginModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveLoginResModel.html">SDLiveLoginResModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveManager.html">SDLiveManager</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePageContainerView.html">SDLivePageContainerView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePaperModel.html">SDLivePaperModel</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLivePlayerView.html">SDLivePlayerView</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/SDLiveRoomInfo.html">SDLiveRoomInfo</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Constants.html">Constants</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Constants.html#/c:SDLiveDownloadManager.h@SDLiveDownloadErrorDomain">SDLiveDownloadErrorDomain</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveProjectVersionNumber">SDLiveProjectVersionNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@SDLiveProjectVersionString">SDLiveProjectVersionString</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:SDLiveDownloadManager.h@SunliveDownloadIdentifier">SunliveDownloadIdentifier</a>
              </li>
              <li class="nav-group-task">
                <a href="Constants.html#/c:@sdlive_sdk_version">sdlive_sdk_version</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/SDLiveClientType.html">SDLiveClientType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveConfig.html">SDLiveConfig</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveIMChatRoomEventType.html">SDLiveIMChatRoomEventType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveImageLoadStatus.html">SDLiveImageLoadStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMovieLoadState.html">SDLiveMovieLoadState</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMoviePlaybackState.html">SDLiveMoviePlaybackState</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveMovieScalingMode.html">SDLiveMovieScalingMode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomEvent.html">SDLiveRoomEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomPeopleEvent.html">SDLiveRoomPeopleEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveRoomStatus.html">SDLiveRoomStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveServerErrorCode.html">SDLiveServerErrorCode</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveSocketError.html">SDLiveSocketError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDLiveUserRoleType.html">SDLiveUserRoleType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/SDSocketState.html">SDSocketState</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/SDLiveDownloadManagerDelegate.html">SDLiveDownloadManagerDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveIMDelegate.html">SDLiveIMDelegate</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveLogger.html">SDLiveLogger</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/SDLiveManagerDelegate.html">SDLiveManagerDelegate</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Type%20Definitions.html">Type Definitions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveAudioService.h@T@SDLiveAudioServiceBlock">SDLiveAudioServiceBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadDeleteResult.html">SDLiveDownloadDeleteResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadError.html">SDLiveDownloadError</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadResult.html">SDLiveDownloadResult</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDLiveDownloadStatus.html">SDLiveDownloadStatus</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLiveDefine.h@T@SDLiveNumber">SDLiveNumber</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerCompleteBlock">SDLivePlayerCompleteBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerErrorBlock">SDLivePlayerErrorBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerLoadStatusCallBlock">SDLivePlayerLoadStatusCallBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions.html#/c:SDLivePlayerView.h@T@SDLivePlayerStatusCallBlock">SDLivePlayerStatusCallBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SDVideoType.html">SDVideoType</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/SUNLAND_SDK_DOWNLOAD_LIVE_ERROR.html">SUNLAND_SDK_DOWNLOAD_LIVE_ERROR</a>
              </li>
              <li class="nav-group-task">
                <a href="Type%20Definitions/UrlSteamType.html">UrlSteamType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/c:@F@SDLiveLogEventDebug">SDLiveLogEventDebug</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='1-1-0-2019-11-4' class='heading'>1.1.0 [2019-11-4]</h1>

<ol>
<li>重构了离线下载部分</li>
</ol>
<h1 id='1-0-9-6-2019-10-23' class='heading'>1.0.9.6 [2019-10-23]</h1>

<ol>
<li>修复下载session invalid 导致的 crash</li>
</ol>
<h1 id='1-0-9-5-2019-10-17' class='heading'>1.0.9.5 [2019-10-17]</h1>

<ol>
<li>修复埋点的超级大的loadTime</li>
</ol>
<h1 id='1-0-9-4' class='heading'>1.0.9.4</h1>

<ol>
<li>紧急修复IM收不到消息的bug</li>
</ol>
<h1 id='1-0-9-3-修复bug-2019-10-8' class='heading'>1.0.9.3 修复bug【2019-10-8】</h1>

<ol>
<li>优化了下载时进行快照存档转换导致的内存过大的问题</li>
<li>去掉了对 SDWebImage 的依赖</li>
</ol>
<h1 id='1-0-9-平台化碎片化' class='heading'>1.0.9 平台化碎片化</h1>

<ol>
<li>SDLiveManager 新增平台化碎片化初始化方法</li>
</ol>
<pre class="highlight plaintext"><code>/**
 平台化业务方碎片化视频初始化
 @param model SDLiveLoginInfoModel
 @param videoId 短视频ID
 @param extraJson 短视频扩展Json
 @param startSequence 短视频开始sequence
 @param endSequence 短视频结束sequence
 @return SDLiveManager
 */
- (instancetype _Nonnull)initLiveWith:(SDLiveLoginInfoModel* _Nonnull)model
                              videoId:(SDLiveNumber)videoId
                            extraJson:(NSString* _Nonnull)extraJson
                        startSequence:(SDLiveNumber)startSequence
                          endSequence:(SDLiveNumber)endSequence;
</code></pre>

<ol>
<li>SDLiveAudioService 新增平台化音频下载方法</li>
</ol>
<pre class="highlight plaintext"><code>/**
 平台化处理

 @param model SDLiveLoginInfoModel 平台化参数
 @param complete 返回（downloadUrl，fileSize，error）
 @return 操作成功或失败
 */

- (BOOL)requestAudioInfomationWithPlatInfo:(SDLiveLoginInfoModel *)model
                                  complete:(SDLiveAudioServiceBlock)complete;
</code></pre>

<ol>
<li>SDLiveDownloadManager 类新增平台化下载方法
&ldquo;`
/**
平台化下载</li>
</ol>

<p>@param item SDLiveDownloadItem，liveId 建议传入 roomId
 @param model SDLiveLoginInfoModel
 */</p>

<ul>
<li>(void)downloadItem:(SDLiveDownloadItem *)item withPlatInfo:(SDLiveLoginInfoModel *)model;
&rdquo;`</li>
</ul>
<h1 id='1-0-8-1' class='heading'>1.0.8.1</h1>

<ol>
<li>修复bug</li>
</ol>
<h1 id='1-0-8-碎片化' class='heading'>1.0.8 碎片化</h1>

<p>要注意的：</p>

<ol>
<li>新增了碎片化初始化方法</li>
</ol>
<pre class="highlight plaintext"><code>/**
 碎片化视频初始化

 @param token token
 @param liveId liveID的
 @param channelCode 渠道码
 @param videoId 短视频ID
 @param extraJson 短视频扩展Json
 @param startSequence 短视频开始sequence
 @param endSequence 短视频结束sequence
 @return SDLiveManager
 */
- (instancetype _Nonnull)initWithToken:(NSString* _Nonnull)token
                             andLiveId:(NSString* _Nonnull)liveId
                           channelCode:(NSString* _Nonnull)channelCode
                               videoId:(SDLiveNumber)videoId
                             extraJson:(NSString* _Nonnull)extraJson
                         startSequence:(SDLiveNumber)startSequence
                           endSequence:(SDLiveNumber)endSequence;
</code></pre>

<p>不用管的：</p>

<ol>
<li>修复了图片加载低概率出现的白屏现象</li>
</ol>
<h1 id='1-0-7-直播埋点' class='heading'>1.0.7 直播埋点</h1>

<p>不用管的：</p>

<ol>
<li>新增一些卡顿事件和数据统计的埋点，具体见需求：<a href="http://pm.shangdejigou.cn/zentao/story-view-9478-3-project-2753.html%EF%BC%8C%E5%9F%8B%E7%82%B9%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3%EF%BC%9Ahttp://172.16.116.49/SunlivePaper/LiveStuckReport.html">http://pm.shangdejigou.cn/zentao/story-view-9478-3-project-2753.html，埋点接口文档：http://172.16.116.49/SunlivePaper/LiveStuckReport.html</a></li>
<li>IJKPlayer更新：直播同步序列通过SEI传递，代替之前的metadata</li>
<li>对SDWebImage做了适配，现在支持SDWebImage3.0、4.0、5.0的版本了</li>
</ol>

<p>要注意的：</p>

<ol>
<li><p>添加了 _Nonnull、_Nullable 等关键字，所以会提示不满足代理方法，把之前的代理方法的 ! 号去掉就行了</p></li>
<li><p>SDLiveManager 新增了当前加载的图片状态的代理方法，可以判断当前图片是否加载失败了</p></li>
</ol>
<pre class="highlight plaintext"><code>    /**
    课件加载回调，加载失败的时候，业务方可以考虑增加重试按钮，重新加载课件
    加载恢复正常的时候，业务方可以隐藏重试按钮

    @param status SDLiveImageLoadStatus
    - SDLiveImageLoadStatusFailed: 加载失败
    - SDLiveImageLoadStatusNormal: 加载恢复正常
    */
    -(void)manager:(SDLiveManager* _Nonnull)manager
    didChangeImageStatus:(SDLiveImageLoadStatus)status;
</code></pre>

<ol>
<li><p>SDLiveManager 新增了加载当前失败的图片的方法</p>
<pre class="highlight plaintext"><code>/**
重新加载课件图片，在收到课件加载失败的回调的时候，可以调用该方法
*/
- (void)reloadPage;
</code></pre></li>
<li><p>SDLiveManager 新增了重试方法，可以重新走整个直播登录以及视频连接的流程，适合在播放器报错之后使用</p>
<pre class="highlight plaintext"><code>/**
重新走一遍登录流程、开始播放视频，当视频出现问题的时候，可以使用该方法
*/
- (void)reStart;
</code></pre></li>
<li><p>SDLiveManager 新增了当前直播间人数变化的代理方法</p></li>
</ol>
<pre class="highlight plaintext"><code>    /**
    直播间人数发生变化

    @param manager SDLiveManager
    @param userCount 直播间总人数
    */
    - (void)managerLive:(SDLiveManager* _Nonnull)manager
    userCountDidChange:(NSInteger)userCount;
</code></pre>
<h1 id='1-0-6-平台化版本' class='heading'>1.0.6 平台化版本</h1>

<ol>
<li>为了应对平台化，另外提供了framework的方式进行集成，当前，也可以继续使用源码方式进行集成</li>
</ol>
<pre class="highlight plaintext"><code>    pod 'SDLiveFramework',:git=&gt;'http://192.168.0.224/iosenterprise/SDLiveProject.git',:tag=&gt;'tag_sdk_1.0.6'
</code></pre>

<ol>
<li>添加了平台化的初始化方法</li>
<li>调整了与欢拓兼容的方式，欢拓的SDK文件不再放在尚德直播Framework里，而是放在集成的主工程里。假如是Swift工程，需要将欢拓的头文件添加到Bridging-Header.h文件里</li>
<li><p>IM协议新增了公告</p>
<pre class="highlight plaintext"><code>func didReceiveAnnounce(_ announce: SDLiveIMAnnounceModel!) {

}
</code></pre></li>
<li><p>修改了环境切换方法</p>
<pre class="highlight plaintext"><code>//生产环境
SDLiveManager.setConfigType(SDLiveConfig.product)
//测试环境
SDLiveManager.setConfigType(SDLiveConfig.QA)
//联调环境
SDLiveManager.setConfigType(SDLiveConfig.develop)
</code></pre></li>
<li><p>首屏加载视频的时候，不上报卡顿</p></li>
<li><p>修复了直播IM的单人禁言协议</p></li>
<li><p>修复了直播下可能出现的视频卡住的情况</p></li>
</ol>
<h1 id='1-0-5-vcache修复版本' class='heading'>1.0.5 vcache修复版本</h1>

<ol>
<li>点播开始上报埋点</li>
<li>埋点增加两个参数，设备型号和系统版本</li>
<li>修正vcache，使事件与视频同步</li>
<li>IM新增接口，透传收到的消息体给业务方</li>
</ol>
<pre class="highlight plaintext"><code>/**
 收到服务端发来的消息体
 错误信息：
 cmd=4，result=14，两秒太频繁了【需提示用户】

 @param SDLiveIMResponse 消息体
 */
@optional
-(void)didReceiveResponse:(SDLiveIMResponse*)response;


</code></pre>

<ol>
<li>下载课程增加channelCode参数</li>
</ol>
<pre class="highlight plaintext"><code>/*下载Item*/
- (void)downloadItem:(SDLiveDownloadItem *)item withToken: (NSString *)token andChannelCode:(NSString*)channelCode;
</code></pre>
<h1 id='1-0-4-直播优化需求' class='heading'>1.0.4 直播优化需求</h1>

<p>SDLiveManagerDelegate 添加2个回调方法，现在一共要处理3个错误回调方法</p>
<pre class="highlight plaintext"><code>//直播/点播场景下，外部传入的token认证失败的错误
- (void)manager:(SDLiveManager*)manager authOnError:(NSError*)error;
//业务上的错误回调，包括直播推流端推送的错误
- (void)manager:(SDLiveManager*)manager onError:(NSError*)error;
//播放器错误回调，播放器播放遇到错误，包括IJKPlayer自身的bug、拉流链接错误等，会触发。该处返回的是IJKPlayer错误通知的UserInfo
//仅展示不用处理
- (void)manager:(SDLiveManager*)manager onPlayError:(NSError*)error;
</code></pre>

<p>SDLiveManager添加属性</p>
<pre class="highlight objective_c"><code><span class="c1">//课件区域的占位图，当课件图片在加载中的时候展示该图片，使用 UIViewContentModeCenter 模式来展示，默认已经添加了占位图。
</span><span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">strong</span><span class="p">)</span> <span class="n">UIImage</span><span class="o">*</span> <span class="n">pageViewPlaceHolderImage</span><span class="p">;</span>
<span class="err">拉流的</span><span class="n">tcp</span><span class="err">速度，“</span><span class="mi">20</span><span class="n">KB</span><span class="o">/</span><span class="n">s</span><span class="err">”</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">nonatomic</span><span class="p">,</span><span class="n">strong</span><span class="p">,</span> <span class="n">readonly</span><span class="p">)</span> <span class="n">NSString</span><span class="o">*</span> <span class="n">tcpSpeed</span><span class="p">;</span>
</code></pre>

<p>IM的心跳间隔改为20秒</p>

          </section>
        </section>
        <section id="footer">
          <p>2019@Sunland</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.11.2</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
